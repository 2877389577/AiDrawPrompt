<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIç»˜ç”»æç¤ºè¯ç‚¼é‡‘æœ¯å¸ˆ | AI Art Prompt Alchemist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            height: 300px;
            max-height: 350px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Soft Animations */
        .fade-in {
            animation: fadeIn 0.4s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .keyword-card {
            transition: all 0.2s ease;
        }

        .keyword-card:active {
            transform: scale(0.95);
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals & Earth Tones -->
    <!-- Background: #FDFBF7 (Warm White) -->
    <!-- Surface: #FFFFFF (White) -->
    <!-- Primary Text: #2D3748 (Charcoal) -->
    <!-- Accents: #E2E8F0 (Slate), #C6F6D5 (Soft Green), #FEEBC8 (Soft Orange) -->
</head>

<body class="bg-[#FDFBF7] text-gray-800 font-sans min-h-screen flex flex-col">

    <!-- Application Structure Plan: 
         1. Header: Title and Purpose.
         2. Main Layout (Grid): 
            - Left/Top (Navigation): Categorized tabs for prompt types.
            - Center (Content): Dynamic grid of keyword cards + Educational context text.
            - Right (Analysis): Charts showing prompt balance and keyword weights.
         3. Footer (Sticky): The "Prompt Builder" console. Users click cards to populate this.
         4. Interaction: Click to add, Hover for details.
    -->

    <!-- Header -->
    <header class="bg-white border-b border-stone-200 shadow-sm sticky top-0 z-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="text-2xl">âš—ï¸</span>
                <h1 class="text-xl font-bold tracking-tight text-stone-800">AIç»˜ç”»æç¤ºè¯<span
                        class="text-amber-600">ç‚¼é‡‘æœ¯å¸ˆ</span></h1>
            </div>
            <div class="text-sm text-stone-500 hidden sm:block">æ„å»º â€¢ æ¢ç´¢ â€¢ ä¼˜åŒ–</div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 grid grid-cols-1 lg:grid-cols-12 gap-8">

        <!-- Sidebar Navigation (Categories) -->
        <nav class="lg:col-span-2 flex flex-row lg:flex-col gap-2 overflow-x-auto lg:overflow-visible pb-2 lg:pb-0"
            id="categoryNav">
            <!-- Populated by JS -->
        </nav>

        <!-- Center Content (Context & Grid) -->
        <section class="lg:col-span-7 flex flex-col gap-6">

            <!-- Context Block -->
            <div id="introSection" class="bg-white p-6 rounded-xl border border-stone-100 shadow-sm fade-in">
                <h2 id="sectionTitle" class="text-2xl font-bold text-stone-800 mb-2"></h2>
                <p id="sectionDesc" class="text-stone-600 leading-relaxed"></p>
                <div class="mt-4 flex flex-wrap gap-2" id="sectionTags">
                    <!-- Section tags like "High Impact", "Base Layer" -->
                </div>
            </div>

            <!-- Keyword Grid -->
            <div id="keywordGrid" class="grid grid-cols-2 sm:grid-cols-3 gap-3 fade-in">
                <!-- Populated by JS -->
            </div>

        </section>

        <!-- Right Analysis Column -->
        <aside class="lg:col-span-3 flex flex-col gap-6">

            <!-- Visualization 1: Prompt Balance Radar -->
            <div class="bg-white p-4 rounded-xl border border-stone-100 shadow-sm">
                <div class="mb-2 border-b border-stone-100 pb-2">
                    <h3 class="font-bold text-stone-700">æç¤ºè¯ç»“æ„åˆ†æ</h3>
                    <p class="text-xs text-stone-500">ä¸€ä¸ªä¼˜ç§€çš„æç¤ºè¯éœ€è¦å¤šç»´åº¦çš„æè¿°å¹³è¡¡ã€‚</p>
                </div>
                <!-- Chart Container -->
                <div class="chart-container h-64">
                    <canvas id="balanceChart"></canvas>
                </div>
                <!-- Context for Viz 1 -->
                <p class="text-xs text-stone-500 mt-2 italic">
                    æ­¤é›·è¾¾å›¾å±•ç¤ºäº†ä¸åŒæç¤ºè¯ç±»åˆ«åœ¨æ„å»ºç”»é¢æ—¶çš„é€»è¾‘ç»´åº¦ã€‚å°è¯•ä»ä¸åŒç±»åˆ«é€‰æ‹©å…³é”®è¯ä»¥è·å¾—æ›´ä¸°å¯Œçš„ç»“æœã€‚
                </p>
            </div>

            <!-- Visualization 2: Keyword Impact -->
            <div class="bg-white p-4 rounded-xl border border-stone-100 shadow-sm hidden md:block">
                <div class="mb-2 border-b border-stone-100 pb-2">
                    <h3 class="font-bold text-stone-700">æƒé‡å½±å“åŠ›æŒ‡å—</h3>
                    <p class="text-xs text-stone-500">ä¸åŒç±»å‹çš„è¯å¯¹ç”»é¢ç”Ÿæˆçš„å¹²æ‰°ç¨‹åº¦ã€‚</p>
                </div>
                <!-- Chart Container -->
                <div class="chart-container h-48">
                    <canvas id="impactChart"></canvas>
                </div>
            </div>

            <!-- Helper Tips Box -->
            <div class="bg-amber-50 p-4 rounded-xl border border-amber-100">
                <h4 class="font-bold text-amber-800 text-sm mb-1">ğŸ’¡ ç‚¼é‡‘æœ¯å£«ç§˜ç±</h4>
                <p id="randomTip" class="text-sm text-amber-900 leading-snug">
                    åŠ è½½ä¸­...
                </p>
            </div>

        </aside>

    </main>

    <!-- Bottom Sticky Prompt Builder -->
    <footer class="bg-white border-t-2 border-amber-500 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] sticky bottom-0 z-30">
        <div class="max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between">

                <div class="flex-grow w-full">
                    <label class="text-xs font-bold text-stone-500 uppercase tracking-wider mb-1 block">å½“å‰å’’è¯­ (Current
                        Prompt)</label>
                    <div class="relative">
                        <textarea id="promptOutput" readonly
                            class="w-full bg-stone-50 border border-stone-300 rounded-lg py-2 px-3 text-sm text-stone-800 focus:ring-2 focus:ring-amber-500 focus:border-amber-500 h-16 resize-none font-mono"
                            placeholder="ç‚¹å‡»ä¸Šæ–¹çš„å¡ç‰‡å¼€å§‹æ„å»º..."></textarea>
                        <button id="copyBtn"
                            class="absolute right-2 bottom-2 bg-white hover:bg-stone-100 text-stone-600 border border-stone-200 text-xs px-2 py-1 rounded shadow-sm transition-colors">
                            å¤åˆ¶
                        </button>
                    </div>
                </div>

                <div class="flex gap-2 w-full sm:w-auto">
                    <button id="clearBtn"
                        class="flex-1 sm:flex-none bg-stone-100 hover:bg-stone-200 text-stone-600 font-medium py-2 px-4 rounded-lg transition-colors text-sm">
                        æ¸…ç©º
                    </button>
                    <!-- Visual indicator of count -->
                    <div
                        class="hidden sm:flex flex-col items-center justify-center px-4 bg-amber-50 rounded-lg border border-amber-100">
                        <span id="tokenCount" class="text-lg font-bold text-amber-600">0</span>
                        <span class="text-[10px] text-amber-800 uppercase">Tokens</span>
                    </div>
                </div>

            </div>
        </div>
    </footer>

    <!-- Visualization & Content Choices:
         1. Charts: Use Chart.js. 
            - Radar Chart: Ideal for showing the "shape" of data across multiple categories (Style, Light, etc.).
            - Bar Chart: Good for showing linear comparisons (Weight/Impact).
         2. Content: 
            - Cards: Interactive, digestible chunks of info.
            - Text Area: Functional output for the user.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <script>
        // --- Data Source ---
        const appData = {
            categories: [
                {
                    id: 'quality',
                    name: 'è´¨é‡ä¸ä¿®é¥° (Quality)',
                    icon: 'ğŸ’',
                    color: 'text-purple-600',
                    bg: 'bg-purple-50',
                    border: 'border-purple-200',
                    desc: 'å†³å®šç”»é¢çš„ç²¾ç»†åº¦ã€åˆ†è¾¨ç‡å’Œæ•´ä½“è´¨æ„Ÿã€‚è¿™äº›é€šå¸¸æ˜¯æ”¾åœ¨æç¤ºè¯å¼€å¤´æˆ–ç»“å°¾çš„â€œä¸‡é‡‘æ²¹â€è¯æ±‡ã€‚',
                    items: [
                        { name: 'æ°ä½œ', en: 'Masterpiece', desc: 'å¤§å¹…æå‡ç”»é¢ç»†èŠ‚å’Œæ„å›¾è´¨é‡ã€‚' },
                        { name: 'æœ€ä½³ç”»è´¨', en: 'Best Quality', desc: 'ä¿è¯ç”Ÿæˆå›¾åƒçš„æŠ€æœ¯åŸºç¡€è´¨é‡ã€‚' },
                        { name: '4K/8K', en: '4k, 8k', desc: 'å¢åŠ è¶…é«˜åˆ†è¾¨ç‡çš„ç»†èŠ‚çº¹ç†ã€‚' },
                        { name: 'è¶…ç»†èŠ‚', en: 'Highly Detailed', desc: 'å¢åŠ ç”»é¢å†…å®¹çš„ä¸°å¯Œç¨‹åº¦ã€‚' },
                        { name: 'è™šå¹»å¼•æ“5', en: 'Unreal Engine 5', desc: 'å¸¦æ¥3Dæ¸²æŸ“èˆ¬çš„çœŸå®å…‰å½±å’Œè´¨æ„Ÿã€‚' },
                        { name: 'å…‰çº¿è¿½è¸ª', en: 'Ray Tracing', desc: 'æ¨¡æ‹ŸçœŸå®å…‰çº¿åå°„ï¼Œå¢åŠ çœŸå®æ„Ÿã€‚' },
                        { name: 'HDR', en: 'HDR', desc: 'é«˜åŠ¨æ€èŒƒå›´ï¼Œæå‡æ˜æš—å¯¹æ¯”ç»†èŠ‚ã€‚' },
                        { name: 'é”åˆ©èšç„¦', en: 'Sharp Focus', desc: 'ç¡®ä¿ä¸»ä½“æ¸…æ™°ï¼Œè¾¹ç¼˜é”åˆ©ã€‚' }
                    ]
                },
                {
                    id: 'style',
                    name: 'è‰ºæœ¯é£æ ¼ (Style)',
                    icon: 'ğŸ¨',
                    color: 'text-pink-600',
                    bg: 'bg-pink-50',
                    border: 'border-pink-200',
                    desc: 'å®šä¹‰ç”»é¢çš„åŸºè°ƒå’Œè‰ºæœ¯æµæ´¾ã€‚è¿™æ˜¯å†³å®šAIç»˜ç”»â€œåƒä»€ä¹ˆâ€çš„æœ€å…³é”®éƒ¨åˆ†ã€‚',
                    items: [
                        { name: 'èµ›åšæœ‹å…‹', en: 'Cyberpunk', desc: 'é«˜ç§‘æŠ€ä½ç”Ÿæ´»ï¼Œéœ“è™¹ç¯ï¼Œæœºæ¢°æ„Ÿã€‚' },
                        { name: 'è’¸æ±½æœ‹å…‹', en: 'Steampunk', desc: 'å¤å¤æœªæ¥ä¸»ä¹‰ï¼Œé½¿è½®ï¼Œé»„é“œï¼Œç»´å¤šåˆ©äºšé£æ ¼ã€‚' },
                        { name: 'å†™å®ä¸»ä¹‰', en: 'Realistic', desc: 'è¿½æ±‚å¦‚ç…§ç‰‡èˆ¬çš„çœŸå®æ„Ÿã€‚' },
                        { name: 'å‰åœåŠ›é£æ ¼', en: 'Studio Ghibli Style', desc: 'å®«å´éªåŠ¨ç”»é£æ ¼ï¼Œæ¸…æ–°ï¼Œæ‰‹ç»˜æ„Ÿã€‚' },
                        { name: 'æµ®ä¸–ç»˜', en: 'Ukiyo-e', desc: 'æ—¥æœ¬ä¼ ç»Ÿç‰ˆç”»é£æ ¼ï¼Œçº¿æ¡åˆ†æ˜ã€‚' },
                        { name: 'æ²¹ç”»', en: 'Oil Painting', desc: 'åšé‡çš„ç¬”è§¦ï¼Œä¸°å¯Œçš„è‰²å½©å±‚æ¬¡ã€‚' },
                        { name: 'æ°´å½©', en: 'Watercolor', desc: 'æŸ”å’Œï¼Œé€æ˜ï¼Œæ™•æŸ“æ•ˆæœã€‚' },
                        { name: 'åƒç´ ç”»', en: 'Pixel Art', desc: 'å¤å¤æ¸¸æˆé£æ ¼ï¼Œå—çŠ¶åŒ–ã€‚' },
                        { name: 'æç®€ä¸»ä¹‰', en: 'Minimalist', desc: 'å°‘å³æ˜¯å¤šï¼Œå¹²å‡€çš„çº¿æ¡å’Œæ„å›¾ã€‚' },
                        { name: 'æ¦‚å¿µè‰ºæœ¯', en: 'Concept Art', desc: 'æ¸¸æˆ/ç”µå½±è®¾è®¡è‰å›¾é£æ ¼ï¼Œå¤§æ°”ã€‚' }
                    ]
                },
                {
                    id: 'lighting',
                    name: 'å…‰å½±ä¸æ°›å›´ (Lighting)',
                    icon: 'ğŸ’¡',
                    color: 'text-amber-600',
                    bg: 'bg-amber-50',
                    border: 'border-amber-200',
                    desc: 'å…‰çº¿æ˜¯ç”»é¢çš„çµé­‚ã€‚å¥½çš„å…‰å½±æè¿°èƒ½ç¬é—´æå‡ç”»é¢çš„å™äº‹æ„Ÿå’Œç«‹ä½“æ„Ÿã€‚',
                    items: [
                        { name: 'ç”µå½±å…‰', en: 'Cinematic Lighting', desc: 'æå…·æˆå‰§æ€§çš„å…‰å½±æ•ˆæœã€‚' },
                        { name: 'è‡ªç„¶å…‰', en: 'Natural Light', desc: 'æŸ”å’Œï¼Œé€‚åˆæ—¥å¸¸äººåƒå’Œé£æ™¯ã€‚' },
                        { name: 'ä¸è¾¾å°”å…‰', en: 'God Rays', desc: 'é€è¿‡äº‘å±‚æˆ–æ ‘å¶çš„å…‰æŸï¼Œç¥åœ£æ„Ÿã€‚' },
                        { name: 'ä½“ç§¯å…‰', en: 'Volumetric Lighting', desc: 'ç©ºæ°”ä¸­çš„å…‰é›¾æ„Ÿï¼Œå¢åŠ ç©ºé—´æ·±åº¦ã€‚' },
                        { name: 'éœ“è™¹ç¯', en: 'Neon Lights', desc: 'èµ›åšæœ‹å…‹å¿…å¤‡ï¼Œé«˜é¥±å’Œåº¦å†·æš–å¯¹æ¯”ã€‚' },
                        { name: 'ä¼¦å¸ƒæœ—å…‰', en: 'Rembrandt Lighting', desc: 'ç»å…¸äººåƒå¸ƒå…‰ï¼Œè„¸éƒ¨ä¸‰è§’å…‰åŒºã€‚' },
                        { name: 'ç”Ÿç‰©å‘å…‰', en: 'Bioluminescence', desc: 'ç¥ç§˜çš„è“è‰²/ç»¿è‰²è§å…‰ï¼Œé€‚åˆå¥‡å¹»é¢˜æã€‚' },
                        { name: 'é»„é‡‘æ—¶æ®µ', en: 'Golden Hour', desc: 'æ—¥è½å‰çš„é‡‘é»„è‰²æš–å…‰ï¼Œæ¸©é¦¨ã€‚' }
                    ]
                },
                {
                    id: 'camera',
                    name: 'é•œå¤´ä¸è§†è§’ (Camera)',
                    icon: 'ğŸ“·',
                    color: 'text-blue-600',
                    bg: 'bg-blue-50',
                    border: 'border-blue-200',
                    desc: 'æ§åˆ¶ç”»é¢çš„æ„å›¾å’Œè§‚å¯Ÿè§’åº¦ã€‚å¦‚åŒå¯¼æ¼”è°ƒåº¦æ‘„åƒæœºä¸€æ ·æ§åˆ¶AIçš„è§†è§’ã€‚',
                    items: [
                        { name: 'å¹¿è§’', en: 'Wide Angle', desc: 'å±•ç¤ºå®å¤§åœºæ™¯ï¼ŒåŒ…å«æ›´å¤šèƒŒæ™¯ã€‚' },
                        { name: 'ç‰¹å†™', en: 'Close-up', desc: 'èšç„¦é¢éƒ¨æˆ–ç»†èŠ‚ï¼ŒèƒŒæ™¯é€šå¸¸è™šåŒ–ã€‚' },
                        { name: 'å¾®è·', en: 'Macro Lens', desc: 'æè¿‘è·ç¦»æ‹æ‘„å¾®å°ç‰©ä½“ï¼Œå¦‚æ˜†è™«ã€æ°´æ»´ã€‚' },
                        { name: 'é±¼çœ¼', en: 'Fisheye Lens', desc: 'å¼ºçƒˆçš„çƒå½¢ç•¸å˜ï¼Œè§†è§‰å†²å‡»åŠ›å¼ºã€‚' },
                        { name: 'ä¿¯è§†', en: 'Top View', desc: 'ä¸Šå¸è§†è§’ï¼Œå¹³é¢å¸ƒå±€æ„Ÿã€‚' },
                        { name: 'ä»°è§†', en: 'Low Angle', desc: 'ä»ä¸‹å¾€ä¸Šæ‹ï¼Œä½¿ä¸»ä½“æ˜¾å¾—é«˜å¤§å¨ä¸¥ã€‚' },
                        { name: 'èƒŒæ™¯è™šåŒ–', en: 'Bokeh', desc: 'æ¨¡ç³ŠèƒŒæ™¯ï¼Œçªå‡ºä¸»ä½“ã€‚' },
                        { name: 'ç¬¬ä¸€äººç§°', en: 'First-person view', desc: 'æ²‰æµ¸å¼è§†è§’ã€‚' }
                    ]
                },
                {
                    id: 'color',
                    name: 'è‰²å½©è‰²è°ƒ (Color)',
                    icon: 'ğŸŒˆ',
                    color: 'text-teal-600',
                    bg: 'bg-teal-50',
                    border: 'border-teal-200',
                    desc: 'è‰²å½©ä¼ é€’æƒ…ç»ªã€‚æŒ‡å®šè‰²è°ƒå¯ä»¥è®©ç”»é¢é£æ ¼æ›´åŠ ç»Ÿä¸€å’Œé«˜çº§ã€‚',
                    items: [
                        { name: 'ç²‰å½©', en: 'Pastel Colors', desc: 'ä½é¥±å’Œåº¦ï¼ŒæŸ”å’Œæ¸…æ–°ï¼Œå°‘å¥³æ„Ÿã€‚' },
                        { name: 'é²œè‰³', en: 'Vibrant', desc: 'é«˜é¥±å’Œåº¦ï¼Œå……æ»¡æ´»åŠ›å’Œèƒ½é‡ã€‚' },
                        { name: 'å•è‰²', en: 'Monochrome', desc: 'é»‘ç™½æˆ–å•ä¸€è‰²ç›¸ï¼Œè‰ºæœ¯æ„Ÿå¼ºã€‚' },
                        { name: 'è«å…°è¿ªè‰²', en: 'Morandi Palette', desc: 'é«˜çº§ç°è°ƒï¼Œé™è°§å¹³å’Œã€‚' },
                        { name: 'èµ›åšè‰²å½©', en: 'Cyberpunk Colors', desc: 'é’è‰²ä¸æ´‹çº¢è‰²çš„å¯¹æ¯”ã€‚' },
                        { name: 'å¤å¤', en: 'Vintage', desc: 'æ³›é»„ï¼Œæ—§ç…§ç‰‡è´¨æ„Ÿã€‚' },
                        { name: 'å†·è‰²è°ƒ', en: 'Cool Tone', desc: 'è“ã€é’ã€ç´«ï¼Œå†·é™ã€ç§‘æŠ€æˆ–å¿§éƒã€‚' },
                        { name: 'æš–è‰²è°ƒ', en: 'Warm Tone', desc: 'çº¢ã€æ©™ã€é»„ï¼Œæ¸©æš–ã€çƒ­çƒˆæˆ–æ€€æ—§ã€‚' }
                    ]
                }
            ],
            tips: [
                "æç¤ºè¯é¡ºåºå¾ˆé‡è¦ï¼šè¶Šé å‰çš„è¯æƒé‡é€šå¸¸è¶Šé«˜ã€‚",
                "ä½¿ç”¨ (parentheses) æ‹¬å·å¯ä»¥å¢åŠ è¯çš„æƒé‡ï¼Œä¾‹å¦‚ (best quality:1.2)ã€‚",
                "å¦‚æœç”»é¢å‡ºç°å¤šä½™çš„æ‰‹æŒ‡æˆ–è‚¢ä½“ï¼Œå°è¯•åœ¨è´Ÿé¢æç¤ºè¯ä¸­åŠ å…¥ 'bad anatomy'ã€‚",
                "ä¸çŸ¥é“å†™ä»€ä¹ˆé£æ ¼ï¼Ÿè¯•è¯•åŠ ä¸Š 'trending on artstation'ã€‚",
                "å…·ä½“çš„è‰ºæœ¯å®¶åå­—å¾€å¾€æ¯”é€šç”¨çš„é£æ ¼è¯æ›´æœ‰åŠ›ï¼Œä¾‹å¦‚ 'by Greg Rutkowski'ã€‚",
                "ç®€å•çš„è¯æ±‡ç»„åˆå¾€å¾€æ¯”é•¿ç¯‡å¤§è®ºçš„å¥å­æ•ˆæœæ›´å¥½ã€‚"
            ]
        };

        // --- State Management ---
        let currentCategory = appData.categories[0];
        let activePrompt = [];

        // --- DOM Elements ---
        const categoryNav = document.getElementById('categoryNav');
        const introSection = document.getElementById('introSection');
        const sectionTitle = document.getElementById('sectionTitle');
        const sectionDesc = document.getElementById('sectionDesc');
        const sectionTags = document.getElementById('sectionTags');
        const keywordGrid = document.getElementById('keywordGrid');
        const promptOutput = document.getElementById('promptOutput');
        const copyBtn = document.getElementById('copyBtn');
        const clearBtn = document.getElementById('clearBtn');
        const tokenCount = document.getElementById('tokenCount');
        const randomTip = document.getElementById('randomTip');

        // --- Initialization ---
        function init() {
            renderNav();
            renderCategory(currentCategory);
            renderTip();
            initCharts();

            // Interaction Listeners
            copyBtn.addEventListener('click', () => {
                promptOutput.select();
                document.execCommand('copy');
                const originalText = copyBtn.innerText;
                copyBtn.innerText = "å·²å¤åˆ¶!";
                setTimeout(() => copyBtn.innerText = originalText, 1500);
            });

            clearBtn.addEventListener('click', () => {
                activePrompt = [];
                updatePromptOutput();
            });
        }

        // --- Visualization: Chart.js ---
        let balanceChartInstance = null;
        let impactChartInstance = null;

        function initCharts() {
            // 1. Radar Chart: Prompt Composition Balance
            const ctxBalance = document.getElementById('balanceChart').getContext('2d');
            balanceChartInstance = new Chart(ctxBalance, {
                type: 'radar',
                data: {
                    labels: ['è´¨é‡ (Quality)', 'é£æ ¼ (Style)', 'å…‰å½± (Light)', 'é•œå¤´ (Camera)', 'è‰²å½© (Color)'],
                    datasets: [{
                        label: 'å½“å‰æç¤ºè¯æ„æˆ',
                        data: [0, 0, 0, 0, 0], // Initial state
                        backgroundColor: 'rgba(245, 158, 11, 0.2)', // Amber-500 low opacity
                        borderColor: 'rgba(245, 158, 11, 1)',
                        pointBackgroundColor: 'rgba(245, 158, 11, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(245, 158, 11, 1)'
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: '#e5e7eb' },
                            grid: { color: '#e5e7eb' },
                            pointLabels: {
                                font: { size: 12, family: 'sans-serif' },
                                color: '#4b5563'
                            },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: { display: false, maxTicksLimit: 5 }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            // 2. Bar Chart: Keyword Type Impact (Static/Educational)
            const ctxImpact = document.getElementById('impactChart').getContext('2d');
            impactChartInstance = new Chart(ctxImpact, {
                type: 'bar',
                data: {
                    labels: ['ä¸»ä½“', 'è‰ºæœ¯é£æ ¼', 'å…‰å½±', 'è´¨é‡è¯', 'è‰²å½©'],
                    datasets: [{
                        label: 'å¯¹ç”»é¢ç”Ÿæˆçš„å½±å“åŠ› (1-10)',
                        data: [10, 8.5, 7, 5, 4], // Static educational data
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.6)', // Red
                            'rgba(236, 72, 153, 0.6)', // Pink
                            'rgba(245, 158, 11, 0.6)', // Amber
                            'rgba(147, 51, 234, 0.6)', // Purple
                            'rgba(20, 184, 166, 0.6)'  // Teal
                        ],
                        borderColor: [
                            'rgba(239, 68, 68, 1)',
                            'rgba(236, 72, 153, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(147, 51, 234, 1)',
                            'rgba(20, 184, 166, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            grid: { display: false },
                            max: 10
                        },
                        y: {
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return 'å½±å“åŠ›æŒ‡æ•°: ' + context.raw;
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateCharts() {
            // Count keywords per category
            const counts = {
                quality: 0,
                style: 0,
                lighting: 0,
                camera: 0,
                color: 0
            };

            activePrompt.forEach(item => {
                if (counts[item.categoryId] !== undefined) {
                    counts[item.categoryId]++;
                }
            });

            // Update Radar Chart Data
            // We clamp values to make the chart look nice, max 5 per category
            balanceChartInstance.data.datasets[0].data = [
                counts.quality,
                counts.style,
                counts.lighting,
                counts.camera,
                counts.color
            ];
            balanceChartInstance.update();
        }

        // --- Logic Functions ---

        function renderNav() {
            categoryNav.innerHTML = '';
            appData.categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = `flex-shrink-0 lg:flex-shrink w-auto lg:w-full text-left px-4 py-3 rounded-lg flex items-center gap-3 transition-colors ${cat.id === currentCategory.id ? 'bg-stone-800 text-white shadow-md' : 'bg-white text-stone-600 hover:bg-stone-50 border border-transparent hover:border-stone-200'}`;
                btn.innerHTML = `<span class="text-xl">${cat.icon}</span><span class="font-medium whitespace-nowrap">${cat.name.split(' ')[0]}</span>`;
                btn.onclick = () => {
                    currentCategory = cat;
                    renderNav(); // Re-render to update active state styling
                    renderCategory(cat);
                };
                categoryNav.appendChild(btn);
            });
        }

        function renderCategory(category) {
            // Update Context Section
            sectionTitle.innerHTML = `<span class="${category.color}">${category.icon}</span> ${category.name}`;
            sectionDesc.textContent = category.desc;

            // Update Grid
            keywordGrid.innerHTML = '';
            category.items.forEach(item => {
                const card = document.createElement('div');
                card.className = `keyword-card cursor-pointer group bg-white border ${category.border} hover:border-transparent hover:shadow-lg hover:ring-2 hover:ring-opacity-50 hover:${category.color.replace('text', 'ring')} rounded-xl p-4 flex flex-col justify-between h-32 relative overflow-hidden`;

                // Card Content
                card.innerHTML = `
                    <div class="z-10">
                        <div class="font-bold text-stone-800 text-lg group-hover:${category.color} transition-colors">${item.name}</div>
                        <div class="font-mono text-xs text-stone-400 mt-1">${item.en}</div>
                    </div>
                    <div class="text-xs text-stone-500 mt-2 line-clamp-2 z-10 relative">
                        ${item.desc}
                    </div>
                    <!-- Decorative background wash -->
                    <div class="absolute -right-4 -bottom-4 w-16 h-16 ${category.bg} rounded-full opacity-50 z-0"></div>
                `;

                card.onclick = () => addToPrompt(item, category.id);
                keywordGrid.appendChild(card);
            });
        }

        function addToPrompt(item, categoryId) {
            // Prevent duplicates (optional, but good UX)
            if (activePrompt.some(p => p.en === item.en)) return;

            activePrompt.push({ ...item, categoryId });
            updatePromptOutput();

            // Visual feedback on the button
            // (Simplified by the chart update)
        }

        function updatePromptOutput() {
            const text = activePrompt.map(p => p.en).join(', ');
            promptOutput.value = text;
            tokenCount.textContent = activePrompt.length;

            updateCharts();
        }

        function renderTip() {
            const tip = appData.tips[Math.floor(Math.random() * appData.tips.length)];
            randomTip.textContent = tip;
        }

        // Start
        window.onload = init;

    </script>
</body>

</html>